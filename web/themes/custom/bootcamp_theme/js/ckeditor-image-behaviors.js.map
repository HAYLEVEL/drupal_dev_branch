{"version":3,"file":"ckeditor-image-behaviors.js","names":["$","Drupal","behaviors","ckeditor5Images","attach","context","once","length","sliderElements","document","querySelectorAll","imageClick","index","sliderElement","setTimeout","toggleClass","swiffyslider","slideTo","onSlideEnd","querySelector","focus","Array","from","forEach","currentActiveSlide","currentActiveSlideIndex","indexOf","textContent","toString","on","$targetArrayItem","this","closest","$targetArray","children","siblings","find","jQuery"],"sources":["ckeditor-image-behaviors.js"],"mappings":"CAAA,SAAWA,EAAGC,GAOZA,EAAOC,UAAUC,gBAAkB,CAKjCC,OAAQ,SAAUC,GAEhB,IAAKC,KAAK,kBAAmB,QAAQC,OAGnC,OAEF,IAAIC,EAAiBC,SAASC,iBAAiB,0GAc/C,SAASC,EAAWC,EAAOC,GACzBC,YAAW,KACTd,EAAEa,GAAeE,YAAY,UAE7BC,aAAaC,QAAQJ,EAAeD,GAEpCI,aAAaE,WAAWL,GAAe,IAAMA,EAAcM,cAAc,qBAAqBC,SAAQ,GACrG,IACL,CArBAC,MAAMC,KAAKd,GAAgBe,SAAQ,SAAUV,GAC3CG,aAAaE,WAAWL,GAAe,WACrC,MAAMW,EAAqBX,EAAcM,cAAc,WACjDM,EAA0BJ,MAAMC,KAAKT,EAAcH,iBAAiB,8BAA8BgB,QAAQF,GAGnFX,EAAcM,cAAc,4DACpCQ,aAAeF,EAA0B,GAAGG,UACnE,GACF,IAeA5B,EAAE,6DAA6D6B,GAAG,SAAS,WAEzE,IAAIC,EAAmB9B,EAAE+B,MAAMC,QAAQ,wBACnCC,EAAejC,EAAE+B,MAAMC,QAAQ,qBAAqBE,SAAS,MACjE,GAAIJ,EAAiBvB,QAAU0B,EAAa1B,OAAQ,CAElDI,EADkBU,MAAMC,KAAKW,GAAcP,QAAQI,EAAiB,IAC5CG,EAAaD,QAAQ,kBAAkBG,SAAS,mCAAmCC,KAAK,oDAAoD,GACtK,CACF,IAGApC,EAAE,oFAAoF6B,GAAG,SAAS,WAEhGlB,EAAW,EAAGX,EAAE+B,MAAMC,QAAQ,kCAAkCI,KAAK,oDAAoD,GAC3H,IAGApC,EAAE,uBAAuB6B,GAAG,SAAS,WACnC7B,EAAE+B,MAAMC,QAAQ,kBAAkBjB,YAAY,SAChD,GACF,EAEH,CAlED,CAkEGsB,OAAQpC","ignoreList":[],"sourcesContent":["(function ($, Drupal) {\n\n  /**\n   * JS behaviors for slider/image gallery within ckeditor.\n   *\n   * @type {Drupal~behavior}\n   */\n  Drupal.behaviors.ckeditor5Images = {\n\n    /**\n     * Add extra content/track changes in slides/etc.\n     */\n    attach: function (context) {\n      // Can not use `window` or `document` directly.\n      if (!once('ckeditor5Images', 'html').length) {\n        // Early return avoid changing the indentation\n        // for the rest of the code.\n        return;\n      }\n      let sliderElements = document.querySelectorAll('.paragraph--type--ckeditor-slides .swiffy-slider:not(.swiffy-slider__gallery-initialization-container)');\n      Array.from(sliderElements).forEach(function (sliderElement) {\n        swiffyslider.onSlideEnd(sliderElement, function () {\n          const currentActiveSlide = sliderElement.querySelector('.active');\n          const currentActiveSlideIndex = Array.from(sliderElement.querySelectorAll('.slider-indicators button')).indexOf(currentActiveSlide);\n          // Now set the number of currently active slide in the appropriate\n          // element.\n          const currentActiveElement = sliderElement.querySelector('.ckeditor__swiffy-slider__slider-progress__current-index');\n          currentActiveElement.textContent = (currentActiveSlideIndex + 1).toString();\n        });\n      });\n\n      // On click handler for slides. If clicked - should open the slider\n      // as gallery and slide to appropriate item.\n      function imageClick(index, sliderElement) {\n        setTimeout(() => {\n          $(sliderElement).toggleClass('active');\n          // Slide to the right image.\n          swiffyslider.slideTo(sliderElement, index);\n          // Listen to slide end and set focus to the container to enable keyboard navigation\n          swiffyslider.onSlideEnd(sliderElement, () => sliderElement.querySelector(\".slider-container\").focus());\n        }, 300)\n      }\n\n      // On click for slider item.\n      $('.media--view-mode-ckeditor-slide-image .field--type-image').on('click', function () {\n        // Find the index of clicked element.\n        let $targetArrayItem = $(this).closest('.slider-container li');\n        let $targetArray = $(this).closest('.slider-container').children('li');\n        if ($targetArrayItem.length && $targetArray.length) {\n          let targetIndex = Array.from($targetArray).indexOf($targetArrayItem[0]);\n          imageClick(targetIndex, $targetArray.closest('.swiffy-slider').siblings('.swiffy-slider__gallery-wrapper').find('.swiffy-slider__gallery-initialization-container')[0]);\n        }\n      });\n\n      // On click for embedded image.\n      $('.media--view-mode-ckeditor-embedded .field--name-field-media-image > picture img').on('click', function () {\n        // Here is index always 0.\n        imageClick(0, $(this).closest('.field--name-field-media-image').find('.swiffy-slider__gallery-initialization-container')[0]);\n      });\n\n      // Close mark behavior.\n      $('.swiffy__close-mark').on('click', function () {\n        $(this).closest('.swiffy-slider').toggleClass('active');\n      })\n    },\n  };\n})(jQuery, Drupal);\n"]}